---
　　layout: default
　　title: Gson库的配置
	published:false
	categories:Android Studio
---

##  Setup

- Gradle
	
	    implementation 'com.github.bumptech.glide:glide:4.8.0'
    	kapt 'com.github.bumptech.glide:compiler:4.8.0'

- 权限

    	<uses-permission android:name="android.permission.INTERNET"/>
    	<uses-permission android:name="android.permission.ACCESS_NETWORK_STATE"/>
    	<uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    	<uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" /> 

- Proguard

		-keep public class * implements com.bumptech.glide.module.GlideModule
		-keep public class * extends com.bumptech.glide.module.AppGlideModule
		-keep public enum com.bumptech.glide.load.ImageHeaderParser$** {
		  **[] $VALUES;
		  public *;
		}

- 添加Module

		@GlideModule
    	class CustomGlideModule : AppGlideModule() {
    
    		override fun applyOptions(context: Context, builder: GlideBuilder) {
		    val maxMemory = Runtime.getRuntime().maxMemory().toInt()
		    val memoryCache = maxMemory / 8
		    builder.setMemoryCache(LruResourceCache(memoryCache.toLong()))
		    //指定的是数据的缓存地址
		    val cacheDir = context.cacheDir
		    //最多可以缓存多少字节的数据
		    val diskCacheSize = 1024 * 1024 * 50
		    //设置磁盘缓存大小
		    builder.setDiskCache(DiskLruCacheFactory(cacheDir.path, "glide", diskCacheSize.toLong()))
		    builder.setLogLevel(Log.DEBUG)
    	}
    
    	override fun isManifestParsingEnabled(): Boolean {
    		return false
    	}
    	}